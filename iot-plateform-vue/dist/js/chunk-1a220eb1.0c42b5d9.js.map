{"version":3,"sources":["webpack:///./src/api/iot/coating.js","webpack:///./src/views/coating/CoatingMachineMonitor.vue","webpack:///./src/views/coating/CoatingMachineMonitor.vue?46ae"],"names":["getStatus","request","url","method","headers","getAlarmInfo","getCoatingStatusCount","class","style","separator","$route","query","position","statusRadio","item","index","key","getStatusRadioColor","onStatusRadioClick","statusCount","coatingStatusInfo","singleMachineInfo","body-style","shadow","span","name","statusType","getMachineStatus","status","isOnline","totalNums","runNo","created","this","getCoatingMachineInfo","timer","setInterval","computed","pages","setDefaultCount","params","setStatusRadioValue","refreshPage","coatingMachineInfoList","forEach","statusName","checkCoatingPhase","statusRadioValue","indexOf","push","methods","$router","fullPath","setAllStatusRadioValue","machineName","statusCode","idx","splice","then","response","responseData","data","code","site","beforeUnmount","clearInterval","pathStatusInfo","render"],"mappings":"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","file":"js/chunk-1a220eb1.0c42b5d9.js","sourcesContent":["import request from '@/utils/request'\n\nexport function getStatus() {\n    return request({\n        url: '/coating/coatingDashboard/getStatus',\n        method: 'get',\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    })\n}\n\nexport function getAlarmInfo() {\n    return request({\n        url: '/coating/coatingDashboard/getAlarmInfo',\n        method: 'get',\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    })\n}\n\nexport function getCoatingStatusCount() {\n    return request({\n        url: '/coating/coatingDashboard/getStatusCount',\n        method: 'get',\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    })\n}\n","<template>\r\n  <div>\r\n    <div class=\"crumbs\">\r\n      <el-breadcrumb separator=\"/\">\r\n        <el-breadcrumb-item>\r\n          <i class=\"el-icon-lx-calendar\"></i> 镀膜机监控\r\n        </el-breadcrumb-item>\r\n        <el-breadcrumb-item>镀膜机{{ this.$route.query.position }}期</el-breadcrumb-item>\r\n      </el-breadcrumb>\r\n    </div>\r\n    <div class=\"container\">\r\n      <div style=\"margin-bottom: 20px\">\r\n        <div v-for=\"(item, index) of statusRadio\" :key=\"index\" class=\"status_radio_type\"\r\n             :style=\"'background-color:' + getStatusRadioColor(item) + ';text-align:center'\" @click=\"onStatusRadioClick(item)\">\r\n          {{ item + '(' + this.statusCount[item] + ')' }}\r\n        </div>\r\n      </div>\r\n      <el-card v-for=\"(singleMachineInfo, index) of coatingStatusInfo\" :key=\"index\"\r\n               :body-style=\"{ padding: '0px', height:'60px'}\"\r\n               shadow=\"hover\"\r\n               class=\"coating_card_type\"\r\n               style=\"cursor: pointer\">\r\n\r\n        <el-row>\r\n          <el-col>\r\n            <div style=\"font-weight: bold\">\r\n              <el-row\r\n                  style=\"text-align: center;height:30px; font-weight: bold;font-size: 16px;border-bottom: 1px solid cornflowerblue\">\r\n                <el-col :span=\"8\">\r\n                  <p style=\"text-align: center;font-weight: bold;color: #008000;font-size: 24px\">\r\n                    {{ singleMachineInfo.name }}</p>\r\n                </el-col>\r\n                <el-col :span=\"16\">\r\n                  <div\r\n                      :style=\"'background-color:' + statusType[getMachineStatus(singleMachineInfo.status, singleMachineInfo.isOnline)] + ';height:30px;line-height:30px'\">\r\n                    {{ getMachineStatus(singleMachineInfo.status, singleMachineInfo.isOnline) }}\r\n                  </div>\r\n                </el-col>\r\n              </el-row>\r\n              <el-row style=\"text-align: center;height: 30px;line-height: 30px\">\r\n                <el-col :span=\"8\">产能：{{ singleMachineInfo.totalNums }}</el-col>\r\n                <el-col :span=\"16\">累计锅次：{{ singleMachineInfo.runNo }}</el-col>\r\n              </el-row>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n      </el-card>\r\n      <!--      <div v-for=\"(singleMachineInfo, index) of coatingStatusInfo\" :key=\"index\"-->\r\n      <!--           class=\"coating_div_type\">-->\r\n      <!--        <div :class=\"statusType[getMachineStatus(singleMachineInfo.status, singleMachineInfo.isOnline)]\">-->\r\n      <!--          <el-row style=\"margin-bottom: 10px\">-->\r\n      <!--            <el-col :span=\"12\">-->\r\n      <!--              <span style=\"width: 200px\">机台号：{{ singleMachineInfo.name }}</span>-->\r\n      <!--            </el-col>-->\r\n      <!--            <el-col :span=\"12\">-->\r\n      <!--              <span>状态：{{ getMachineStatus(singleMachineInfo.status, singleMachineInfo.isOnline) }}</span>-->\r\n      <!--            </el-col>-->\r\n      <!--          </el-row>-->\r\n      <!--          <el-row>-->\r\n      <!--            <el-col :span=\"12\">-->\r\n      <!--              <span>产能：</span>-->\r\n      <!--              <span>{{ singleMachineInfo.totalNums }}</span>-->\r\n      <!--            </el-col>-->\r\n      <!--            <el-col :span=\"12\">-->\r\n      <!--              <span>累计锅次：</span>-->\r\n      <!--              <span>{{ singleMachineInfo.runNo }}</span>-->\r\n      <!--            </el-col>-->\r\n      <!--          </el-row>-->\r\n      <!--        </div>-->\r\n      <!--      </div>-->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getStatus} from \"@/api/iot/coating\";\r\n\r\nexport default {\r\n  name: \"CoatingMachineMonitor\",\r\n  created() {\r\n    this.getCoatingMachineInfo()\r\n    this.timer = setInterval(() => {\r\n      this.getCoatingMachineInfo()\r\n    }, 10000)\r\n  },\r\n  computed: {\r\n    coatingStatusInfo() {\r\n      const pages = []\r\n      this.setDefaultCount()\r\n      if (this.$route.params.status) {\r\n        this.setStatusRadioValue(this.$route.params.status);\r\n        this.refreshPage()\r\n      }\r\n      this.coatingMachineInfoList.forEach((item) => {\r\n        const statusName = this.getMachineStatus(item.status, item.isOnline)\r\n        if (this.checkCoatingPhase(item.name)) {\r\n          if(this.statusRadioValue.indexOf(statusName) > -1){\r\n            pages.push(item)\r\n          }\r\n          this.statusCount[statusName]++\r\n        }\r\n      })\r\n      return pages\r\n    }\r\n  },\r\n  methods: {\r\n    refreshPage(){\r\n      this.$router.push(this.$route.fullPath)\r\n    },\r\n    setStatusRadioValue(status) {\r\n      this.statusRadioValue = []\r\n      this.statusRadioValue.push(status)\r\n    },\r\n    setAllStatusRadioValue() {\r\n      this.statusRadioValue = ['正常运行', '上料预警', '设备离线']\r\n    },\r\n    checkCoatingPhase(machineName) {\r\n      if (this.$route.query.position === '1') {\r\n        if (machineName.indexOf(\"A\") === 0 ||\r\n            machineName.indexOf(\"B\") === 0 ||\r\n            machineName.indexOf(\"C\") === 0 ||\r\n            machineName.indexOf(\"D\") === 0 ||\r\n            machineName.indexOf(\"E\") === 0 ||\r\n            machineName.indexOf(\"F\") === 0 ||\r\n            machineName.indexOf(\"L\") === 0) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      } else if (this.$route.query.position === '2') {\r\n        if (machineName.indexOf(\"A\") === -1 &&\r\n            machineName.indexOf(\"B\") === -1 &&\r\n            machineName.indexOf(\"C\") === -1 &&\r\n            machineName.indexOf(\"D\") === -1 &&\r\n            machineName.indexOf(\"E\") === -1 &&\r\n            machineName.indexOf(\"F\") === -1 &&\r\n            machineName.indexOf(\"L\") === -1) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      }\r\n    },\r\n    getMachineStatus(statusCode, isOnline) {\r\n      if (!isOnline) {\r\n        return '设备离线'\r\n      } else {\r\n        if (statusCode === 1) {\r\n          return '上料预警'\r\n        } else if (statusCode === 0) {\r\n          return '正常运行'\r\n        } else {\r\n          return '设备离线'\r\n        }\r\n      }\r\n    },\r\n    setDefaultCount() {\r\n      this.statusCount = {\r\n        '设备离线': 0,\r\n        '正常运行': 0,\r\n        '上料预警': 0\r\n      }\r\n    },\r\n    getStatusRadioColor(statusCode) {\r\n      if (this.statusRadioValue.indexOf(statusCode) > -1)\r\n        return this.statusType[statusCode]\r\n      else\r\n        return \"rgba(235,235,235,1)\"\r\n    },\r\n    onStatusRadioClick(statusCode) {\r\n      const idx = this.statusRadioValue.indexOf(statusCode)\r\n      if (idx > -1)\r\n        this.statusRadioValue.splice(idx, 1)\r\n      else\r\n        this.statusRadioValue.push(statusCode)\r\n    },\r\n    getCoatingMachineInfo() {\r\n      getStatus().then((response) => {\r\n        const responseData = response.data\r\n        if (responseData.code === '000000') {\r\n          this.coatingMachineInfoList = responseData.data.site;\r\n        }\r\n      })\r\n    }\r\n  },\r\n  beforeUnmount() {\r\n    clearInterval(this.timer);\r\n  },\r\n  data() {\r\n    return {\r\n      pathStatusInfo:\"\",\r\n      coatingMachineInfoList: [],\r\n      // statusType: {\r\n      //   '设备离线': 'item_coating_offline',\r\n      //   '正常运行': 'item_coating_running',\r\n      //   '上料预警': 'item_coating_alarm'\r\n      // }\r\n      statusType: {\r\n        \"设备离线\": \"gray\",\r\n        \"正常运行\": \"rgba(59,162,114,1)\",\r\n        \"上料预警\": \"rgba(154,96,180,1)\"\r\n      },\r\n      statusRadio: ['正常运行', '上料预警', '设备离线'],\r\n      statusRadioValue: ['正常运行', '上料预警', '设备离线'],\r\n      statusCount: {\r\n        '设备离线': 0,\r\n        '正常运行': 0,\r\n        '上料预警': 0\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import { render } from \"./CoatingMachineMonitor.vue?vue&type=template&id=c4385e24\"\nimport script from \"./CoatingMachineMonitor.vue?vue&type=script&lang=js\"\nexport * from \"./CoatingMachineMonitor.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}