(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06e323f5","chunk-2d209276"],{"25f0":function(e,t,o){"use strict";var n=o("6eeb"),a=o("825a"),l=o("d039"),c=o("ad6d"),r="toString",i=RegExp.prototype,u=i[r],d=l((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),p=u.name!=r;(d||p)&&n(RegExp.prototype,r,(function(){var e=a(this),t=String(e.source),o=e.flags,n=String(void 0===o&&e instanceof RegExp&&!("flags"in i)?c.call(e):o);return"/"+t+"/"+n}),{unsafe:!0})},"466d":function(e,t,o){"use strict";var n=o("d784"),a=o("825a"),l=o("50c4"),c=o("1d80"),r=o("8aa5"),i=o("14c3");n("match",1,(function(e,t,o){return[function(t){var o=c(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,o):new RegExp(t)[e](String(o))},function(e){var n=o(t,e,this);if(n.done)return n.value;var c=a(e),u=String(this);if(!c.global)return i(c,u);var d=c.unicode;c.lastIndex=0;var p,s=[],f=0;while(null!==(p=i(c,u))){var b=String(p[0]);s[f]=b,""===b&&(c.lastIndex=r(u,l(c.lastIndex),d)),f++}return 0===f?null:s}]}))},"4d63":function(e,t,o){var n=o("83ab"),a=o("da84"),l=o("94ca"),c=o("7156"),r=o("9bf2").f,i=o("241c").f,u=o("44e7"),d=o("ad6d"),p=o("9f7f"),s=o("6eeb"),f=o("d039"),b=o("69f3").set,h=o("2626"),m=o("b622"),j=m("match"),O=a.RegExp,g=O.prototype,v=/a/g,L=/a/g,w=new O(v)!==v,x=p.UNSUPPORTED_Y,y=n&&l("RegExp",!w||x||f((function(){return L[j]=!1,O(v)!=v||O(L)==L||"/a/i"!=O(v,"i")})));if(y){var N=function(e,t){var o,n=this instanceof N,a=u(e),l=void 0===t;if(!n&&a&&e.constructor===N&&l)return e;w?a&&!l&&(e=e.source):e instanceof N&&(l&&(t=d.call(e)),e=e.source),x&&(o=!!t&&t.indexOf("y")>-1,o&&(t=t.replace(/y/g,"")));var r=c(w?new O(e,t):O(e,t),n?this:g,N);return x&&o&&b(r,{sticky:o}),r},C=function(e){e in N||r(N,e,{configurable:!0,get:function(){return O[e]},set:function(t){O[e]=t}})},k=i(O),T=0;while(k.length>T)C(k[T++]);g.constructor=N,N.prototype=g,s(a,"RegExp",N)}h("RegExp")},7156:function(e,t,o){var n=o("861d"),a=o("d2bb");e.exports=function(e,t,o){var l,c;return a&&"function"==typeof(l=t.constructor)&&l!==o&&n(c=l.prototype)&&c!==o.prototype&&a(e,c),e}},a89b:function(e,t,o){"use strict";o.r(t),o.d(t,"uploadExcel",(function(){return a})),o.d(t,"getByMonitorNo",(function(){return l})),o.d(t,"updateToolInfo",(function(){return c})),o.d(t,"getMachineList",(function(){return r})),o.d(t,"getMatInfoList",(function(){return i}));var n=o("b775");function a(e){var t=new FormData;return t.append("file",e.file),Object(n["default"])({url:"/moldToolLife/toolLife/uploadExcel",method:"post",data:t})}function l(e){return Object(n["default"])({url:"/moldToolLife/toolLife/getByMonitorNo",method:"get",headers:{"Content-Type":"application/json"},params:{monitorNo:e}})}function c(e){return Object(n["default"])({url:"/moldToolLife/toolLife/updateToolInfo",method:"post",headers:{"Content-Type":"application/json"},data:e})}function r(){return Object(n["default"])({url:"/moldToolLife/toolLife/allMachine",method:"get",headers:{"Content-Type":"application/json"}})}function i(){return Object(n["default"])({url:"/moldToolLife/toolLife/allMatInfo",method:"get",headers:{"Content-Type":"application/json"}})}},d250:function(e,t,o){"use strict";o.r(t);var n=o("7a23"),a={class:"crumbs"},l=Object(n["p"])("i",{class:"el-icon-lx-calendar"},null,-1),c=Object(n["o"])(" 模具IoT "),r=Object(n["o"])("刀具寿命管控"),i={class:"container"},u=Object(n["o"])("查询 "),d=Object(n["o"])("保存 "),p=Object(n["p"])("i",{class:"el-icon-upload"},null,-1),s=Object(n["p"])("div",{class:"el-upload__text"},[Object(n["o"])("将Excel文件拖到此处，或"),Object(n["p"])("em",null,"点击上传")],-1),f={key:0},b={key:1};function h(e,t,o,h,m,j){var O=Object(n["P"])("el-breadcrumb-item"),g=Object(n["P"])("el-breadcrumb"),v=Object(n["P"])("el-input"),L=Object(n["P"])("el-button"),w=Object(n["P"])("el-row"),x=Object(n["P"])("el-option"),y=Object(n["P"])("el-select"),N=Object(n["P"])("el-col"),C=Object(n["P"])("el-upload"),k=Object(n["P"])("el-table-column"),T=Object(n["P"])("el-select-v2"),I=Object(n["P"])("el-table"),E=Object(n["Q"])("loading");return Object(n["G"])(),Object(n["l"])("div",null,[Object(n["p"])("div",a,[Object(n["p"])(g,{separator:"/"},{default:Object(n["eb"])((function(){return[Object(n["p"])(O,null,{default:Object(n["eb"])((function(){return[l,c]})),_:1}),Object(n["p"])(O,null,{default:Object(n["eb"])((function(){return[r]})),_:1})]})),_:1})]),Object(n["p"])("div",i,[Object(n["p"])(w,null,{default:Object(n["eb"])((function(){return[Object(n["p"])(N,{span:10},{default:Object(n["eb"])((function(){return[Object(n["p"])(w,{style:{padding:"10px"}},{default:Object(n["eb"])((function(){return[Object(n["p"])(v,{style:{width:"200px","margin-right":"10px"},modelValue:m.monitorNo,"onUpdate:modelValue":t[1]||(t[1]=function(e){return m.monitorNo=e}),placeholder:"请输入监控号"},null,8,["modelValue"]),Object(n["p"])(L,{style:{"margin-right":"10px"},type:"primary",icon:"el-icon-search",onClick:t[2]||(t[2]=function(e){return j.getByMonitorNo(null)})},{default:Object(n["eb"])((function(){return[u]})),_:1}),Object(n["p"])(L,{style:{"margin-right":"10px"},type:"success",loading:m.saveBtnLoading,icon:"el-icon-check",onClick:t[3]||(t[3]=function(e){return j.saveEditInfo()})},{default:Object(n["eb"])((function(){return[d]})),_:1},8,["loading"])]})),_:1}),Object(n["p"])(w,{style:{padding:"10px"}},{default:Object(n["eb"])((function(){return[Object(n["p"])(y,{modelValue:m.machineName,"onUpdate:modelValue":t[4]||(t[4]=function(e){return m.machineName=e}),filterable:"",placeholder:"请选择机台号"},{default:Object(n["eb"])((function(){return[(Object(n["G"])(!0),Object(n["l"])(n["b"],null,Object(n["N"])(m.machineNameList,(function(e){return Object(n["G"])(),Object(n["l"])(x,{key:e.fequipName,label:e.fequipName,value:e.fequipName},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(n["p"])(w,{style:{padding:"10px",float:"left"}})]})),_:1}),Object(n["p"])(N,{span:14},{default:Object(n["eb"])((function(){return[Object(n["p"])(C,{class:"upload-demo","before-upload":j.beforeUpload,accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","http-request":j.uploadExcel,action:"",multiple:!1,"show-file-list":!1,drag:""},{default:Object(n["eb"])((function(){return[p,s]})),_:1},8,["before-upload","http-request"])]})),_:1})]})),_:1}),Object(n["fb"])(Object(n["p"])(I,{id:"ToolLifeTable",data:m.moldToolLifeSheet,border:"",height:j.tableMaxHeight,key:1,"header-row-class-name":"tableHead",style:{width:"100%","margin-top":"10px"},onCellClick:j.tabClick},{default:Object(n["eb"])((function(){return[Object(n["p"])(k,{width:100,prop:"monitorNo",label:"监控号"}),Object(n["p"])(k,{prop:"programName",label:"程序名"}),Object(n["p"])(k,{width:200,prop:"workpiece",label:"工件名称"}),Object(n["p"])(k,{prop:"material",label:"材质"}),Object(n["p"])(k,{prop:"route",label:"工序"}),Object(n["p"])(k,{width:130,prop:"toolName",label:"刀具名称"}),Object(n["p"])(k,{prop:"toolDiameter",label:"刀具直径"}),Object(n["p"])(k,{prop:"toolNo",label:"刀号"}),Object(n["p"])(k,{prop:"type",label:"类型"}),Object(n["p"])(k,{prop:"margin",label:"余量"}),Object(n["p"])(k,{width:100,prop:"toolValidLength",label:"刀具有效刃长"}),Object(n["p"])(k,{prop:"brand",label:"品牌"}),Object(n["p"])(k,{width:120,prop:"maxDepth",label:"最大深度（Z）"}),Object(n["p"])(k,{prop:"workTime",label:"加工时间"}),Object(n["p"])(k,{prop:"cutDepth",label:"切深"}),Object(n["p"])(k,{prop:"feed",label:"进给"}),Object(n["p"])(k,{prop:"remark",label:"备注"}),Object(n["p"])(k,{width:100,fixed:"left",prop:"machineNo",label:"机台号"},{default:Object(n["eb"])((function(e){return[0===m.machineName.length?(Object(n["G"])(),Object(n["l"])("span",f,Object(n["T"])(e.row.machineNo),1)):(Object(n["G"])(),Object(n["l"])("span",b,Object(n["T"])(m.machineName),1))]})),_:1}),Object(n["p"])(k,{width:120,fixed:"left",prop:"handleCode",label:"刀柄编码"},{default:Object(n["eb"])((function(e){return[e.row.isSelected?(Object(n["G"])(),Object(n["l"])(T,{key:0,size:"mini",modelValue:e.row.matInfo,"onUpdate:modelValue":function(t){return e.row.matInfo=t},filterable:"",options:j.options,"value-key":"handleCode",onChange:function(t){return j.checkDiameter(e.row,e.row.toolDiameter)},onBlur:function(t){return j.cellEvent(e.row)},placeholder:"请选择"},null,8,["modelValue","onUpdate:modelValue","options","onChange","onBlur"])):(Object(n["G"])(),Object(n["l"])("span",{key:1,style:j.getFontColor(e.row.isCheck)},Object(n["T"])(e.row.matInfo.handleCode),5))]})),_:1}),Object(n["p"])(k,{width:120,fixed:"left",prop:"toolCode",label:"刀具编码"},{default:Object(n["eb"])((function(e){return[Object(n["p"])("span",{style:j.getFontColor(e.row.isCheck)},Object(n["T"])(e.row.matInfo.toolCode),5)]})),_:1}),Object(n["p"])(k,{width:130,fixed:"left",prop:"matCode",label:"物料号"},{default:Object(n["eb"])((function(e){return[Object(n["p"])("span",{style:j.getFontColor(e.row.isCheck)},Object(n["T"])(e.row.matInfo.matCode),5)]})),_:1}),Object(n["p"])(k,{width:230,fixed:"left",prop:"matName",label:"物料名称"},{default:Object(n["eb"])((function(e){return[Object(n["p"])("span",{style:j.getFontColor(e.row.isCheck)},Object(n["T"])(e.row.matInfo.matName),5)]})),_:1}),Object(n["p"])(k,{width:200,prop:"createDateTime",label:"创建时间"})]})),_:1},8,["data","height","onCellClick"]),[[E,m.toolLifeLoading]])])])}o("4d63"),o("ac1f"),o("25f0"),o("466d");var m=o("a89b"),j={name:"toolLife",created:function(){this.getAllMachine(),this.getAllMatInfo()},data:function(){return{rules:{diameter:{}},selectLoading:!1,machineName:"",machineNameList:[],matInfoList:[],matInfo:{},monitorNo:"",moldToolLifeSheet:[],toolLifeLoading:!1,saveBtnLoading:!1}},computed:{tableMaxHeight:function(){return window.innerHeight-370+"px"},options:function(){for(var e=[],t=0;t<this.matInfoList.length;t++)e.push({label:this.matInfoList[t].handleCode,value:this.matInfoList[t]});return e}},methods:{cellEvent:function(e){e.isSelected=!e.isSelected},tabClick:function(e,t){switch(t.label){case"刀柄编码":this.cellEvent(e);break;default:return}},beforeUpload:function(e){var t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type;if(!t)return this.$message.error("只能上传xlsx, xls格式的文件！"),!1},saveEditInfo:function(){for(var e=this,t=0;t<this.moldToolLifeSheet.length;t++)if(null!=this.moldToolLifeSheet[t].isCheck&&!this.moldToolLifeSheet[t].isCheck)return void this.$message.error("保存失败，存在直径不匹配的刀柄（表格已标红）");if(this.machineName.length>0)for(var o=0;o<this.moldToolLifeSheet.length;o++)this.moldToolLifeSheet[o].machineNo=this.machineName;this.saveBtnLoading=!0,Object(m["updateToolInfo"])(this.moldToolLifeSheet).then((function(t){var o=t.data;"000000"===o.code?e.$message.success("保存成功！"):e.$message.error("保存失败！"+o.msg),e.saveBtnLoading=!1})).catch((function(t){e.$message.error(t.message),e.saveBtnLoading=!1}))},uploadExcel:function(e){var t=this;Object(m["uploadExcel"])(e).then((function(e){var o=e.data;if("000000"===o.code){var n=o.data;t.getByMonitorNo(n),t.$message.success("上传成功！")}else t.$message.error("上传失败！"+o.msg)})).catch((function(e){t.$message.error(e)}))},getByMonitorNo:function(e){var t=this;this.toolLifeLoading=!0,null==e&&(e=this.monitorNo),Object(m["getByMonitorNo"])(e).then((function(e){var o=e.data;"000000"===o.code?t.moldToolLifeSheet=o.data:t.$message.error("获取失败！"+o.msg),t.toolLifeLoading=!1})).catch((function(e){t.$message.error(e),t.toolLifeLoading=!1}))},getAllMachine:function(){var e=this;Object(m["getMachineList"])().then((function(t){var o=t.data;"000000"===o.code?e.machineNameList=o.data:e.$message.error("获取失败！"+o.msg)})).catch((function(t){e.$message.error(t)}))},getAllMatInfo:function(){var e=this;Object(m["getMatInfoList"])().then((function(t){var o=t.data;"000000"===o.code?e.matInfoList=o.data:e.$message.error("获取失败！"+o.msg)})).catch((function(t){e.$message.error(t)}))},checkDiameter:function(e,t){var o=new RegExp("(D|E)(([1-9]\\d*\\.?\\d*)|(0\\.\\d*[1-9]))"),n=e.matInfo.matName.match(o)[0],a=n.substring(1,n.length);a!==t?(e.isCheck=!1,this.$message.error("直径不匹配，请重新选择！")):e.isCheck=!0,this.cellEvent(e)},getFontColor:function(e){return null==e||e?"color:black":"color:red"}}};j.render=h;t["default"]=j}}]);
//# sourceMappingURL=chunk-06e323f5.9cb52edd.js.map